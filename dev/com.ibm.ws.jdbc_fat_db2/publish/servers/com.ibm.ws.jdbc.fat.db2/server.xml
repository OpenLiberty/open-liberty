<server>
  <featureManager>
    <feature>componenttest-1.0</feature>
    <feature>jdbc-4.2</feature>
    <feature>servlet-3.1</feature>
  </featureManager>
    
  <include location="../fatTestPorts.xml"/>

  <application location="db2fat.war" >
    <classloader commonLibraryRef="DB2Lib"/>
  </application>
    
  <library id="DB2Lib">
    <fileset dir="${shared.resource.dir}/db2"/>
  </library>
    
  <dataSource id="DefaultDataSource">
    <jdbcDriver libraryRef="DB2Lib"/>
    <properties.db2.jcc
      databaseName="${DB2_DBNAME}" serverName="${DB2_HOSTNAME}" portNumber="${DB2_PORT}"
      downgradeHoldCursorsUnderXa="true"/>
    <containerAuthData user="${DB2_USER}" password="${DB2_PASS}"/>
    <recoveryAuthData user="${DB2_USER}" password="${DB2_PASS}"/>
  </dataSource>

  <dataSource jndiName="jdbc/db2">
    <jdbcDriver libraryRef="DB2Lib"/>
    <properties.db2.jcc
      databaseName="${DB2_DBNAME}" serverName="${DB2_HOSTNAME}" portNumber="${DB2_PORT}"
      user="${DB2_USER}" password="${DB2_PASS}"
      affinityFailbackInterval="1h20m30s" allowNullResultSetForExecuteQuery="1"
      commandTimeout="2m30s" connectionTimeout="90s" memberConnectTimeout="100000ms"/>
  </dataSource>
  
  <dataSource jndiName="jdbc/db2-using-driver">
  	<jdbcDriver libraryRef="DB2Lib"/>
  	<properties url="jdbc:db2://${DB2_HOSTNAME}:${DB2_PORT}/${DB2_DBNAME}"
      user="${DB2_USER}" password="${DB2_PASS}" driverType="4"/>
  </dataSource>
  
  <dataSource jndiName="jdbc/db2-using-driver-type" type="java.sql.Driver">
  	<jdbcDriver libraryRef="DB2Lib"/>
  	<properties.db2.jcc url="jdbc:db2://${DB2_HOSTNAME}:${DB2_PORT}/${DB2_DBNAME}"
      user="${DB2_USER}" password="${DB2_PASS}" serverName="${DB2_HOSTNAME}" portNumber="${DB2_PORT}"/>
  </dataSource>
  
  <dataSource jndiName="jdbc/db2-inferred">
    <jdbcDriver libraryRef="DB2Lib"/>
    <properties
      databaseName="${DB2_DBNAME}" serverName="${DB2_HOSTNAME}" portNumber="${DB2_PORT}"
      user="${DB2_USER}" password="${DB2_PASS}" driverType="4"/>
  </dataSource>

  <javaPermission codebase="${shared.resource.dir}db2/*" className="java.security.AllPermission"/>
  <javaPermission className="java.lang.RuntimePermission" name="getClassLoader"/>
</server>