[FEATURE RESOLUTION FAT NOTES][TFB][23-Apr-2024][START]

Several of the feature resolution FATs follow the pattern of:

1) Generating baseline data based on a case generator.
2) Running unit tests which perform resolution and validate the results using the baseline data.

1: Baseline generation

Baseline data is created by running "VersionlessResolutionTest", which starts the server with
parameters which cause baseline data to be generated.

Parameter names are specified in "VerifyEnv".

    String RESULTS_SINGLETON_PROPERTY_NAME = "featureVerify_results_singleton";
    String DURATIONS_SINGLETON_PROPERTY_NAME = "featureVerify_durations_singleton";

    String RESULTS_SERVLET_PROPERTY_NAME = "featureVerify_results_servlet";
    String DURATIONS_SERVLET_PROPERTY_NAME = "featureVerify_durations_servlet";

Parameters are provided for resolution results, and for resolution timing data.

When any of these parameter values is specified as a server environment variable, baseline results
are generated and written to the file as specified through the environment variable.  Baseline
data is generated as a callout during usual feature resolution.  Server class "FeatureManager"
calls out to helper "FeatureResolverBaseline".

Currently, baseline data is written to the autoFVT output directory, for example:   

dev/com.ibm.ws.kernel.feature.resolver_fat/build/libs/autoFVT/output/verify:
  servlet_actual.xml
  servlet_durations.txt
  singleton_actual.xml
  singleton_durations.txt

After generation, the data must be copied from the autoFVT directory to a project directory,
for example:

dev/com.ibm.ws.kernel.feature.resolver_fat/publish/verify/
  servlet_durations.txt
  servlet_actual.xml
  singleton_durations.txt
  singleton_actual.xml

Code references:

Baseline data is generated by setting server environment variables a specified by "VerifyEnv":

dev/com.ibm.ws.kernel.feature.core/com/ibm/ws/kernel/feature/internal/util/
  VerifyEnv.java

Baseline data generation is triggerred from "VersionlessResolutionTest":

dev/com.ibm.ws.kernel.feature.resolver_fat/fat/src/com/ibm/ws/feature/tests/
  VersionlessResolutionTest.java

The actual generation is performed by a callout from "FeatureManager" to "FeatureResolverBaseline":

dev/com.ibm.ws.kernel.feature.core/com/ibm/ws/kernel/feature/internal/
  FeatureManager.java
  FeatureResolverBaseline.java

2: Resolution verification unit tests

The baseline data is used by unit tests.  Here, a common base implementation class provides
general capabilities of reading baseline case data, of performing resolutions for each of
the cases, and for comparing the actual resolution results with the expected resolution results.

Cases currently exist for:

1) All singleton public features (which are not versionless features).
2) All pairs of a versioned servlet feature with a versionless feature.

These unit tests used the pre-generated baseline case data:

  servlet_expected.xml
  singleton_expected.xml 

Other cases are expected to be created.

Code references: 

dev/com.ibm.ws.kernel.feature.resolver_fat/fat/src/com/ibm/ws/feature/tests/
  FeatureResolutionUnitTestBase.java
  BaselineServletUnitTest.java
  BaselineSingletonUnitTest.java

[FEATURE RESOLUTION FAT NOTES][TFB][23-Apr-2024][END]