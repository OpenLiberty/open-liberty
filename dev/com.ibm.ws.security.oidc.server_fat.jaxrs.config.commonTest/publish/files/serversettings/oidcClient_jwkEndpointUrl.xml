<!--
    Copyright (c) 2021 IBM Corporation and others.
    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License 2.0
    which accompanies this distribution, and is available at
    http://www.eclipse.org/legal/epl-2.0/
    
    SPDX-License-Identifier: EPL-2.0

    Contributors:
        IBM Corporation - initial API and implementation
 -->

<server>

	<authFilter id="myAuthFilter">
		<requestUrl
			id="myRequestUrla"
			urlPattern="helloworld"
			matchType="contains" />
		<requestUrl
			id="myRequestUrlb"
			urlPattern="helloworld_"
			matchType="notContain" />
	</authFilter>

	<openidConnectClient
		id="client01"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		jwkEndpointUrl="${oidcJWKValidationURL}"
		signatureAlgorithm="${oidcSignAlg}"
		authFilterRef="myAuthFilter" />



	<authFilter id="notConfiguredAuthFilter">
		<requestUrl
			id="myRequestUrl"
			urlPattern="helloworld_jwk_notConfigured"
			matchType="contains" />
	</authFilter>

	<openidConnectClient
		id="jwkNotConfigured"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		signatureAlgorithm="${oidcSignAlg}"
		authFilterRef="notConfiguredAuthFilter" />

	<authFilter id="emptyAuthFilter">
		<requestUrl
			id="myRequestUrl"
			urlPattern="helloworld_jwk_empty"
			matchType="contains" />
	</authFilter>

	<openidConnectClient
		id="jwkEmpty"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		jwkEndpointUrl=""
		signatureAlgorithm="${oidcSignAlg}"
		authFilterRef="emptyAuthFilter" />


	<authFilter id="stringAuthFilter">
		<requestUrl
			id="myRequestUrl"
			urlPattern="helloworld_jwk_string"
			matchType="contains" />
	</authFilter>

	<openidConnectClient
		id="jwkString"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		jwkEndpointUrl="myDogHasFleas"
		signatureAlgorithm="${oidcSignAlg}"
		authFilterRef="stringAuthFilter" />


	<authFilter id="badUrlAuthFilter">
		<requestUrl
			id="myRequestUrl"
			urlPattern="helloworld_jwk_badUrl"
			matchType="contains" />
	</authFilter>

	<openidConnectClient
		id="jwkBadUrl"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		jwkEndpointUrl="https://localhost:${bvt.prop.security_1_HTTP_default.secure}/endpoint/${providerSample}/jwk"
		signatureAlgorithm="RS256"
		authFilterRef="badUrlAuthFilter" />


	<authFilter id="someOtherUrlAuthFilter">
		<requestUrl
			id="myRequestUrl"
			urlPattern="helloworld_jwk_someOtherUrl"
			matchType="contains" />
	</authFilter>

	<openidConnectClient
		id="jwkSomeOtherUrl"
		scope="openid profile"
		clientId="client01"
		clientSecret="{xor}LDo8LTor"
		sharedKey="secret"
		httpsRequired="false"
		inboundPropagation="required"
		redirectToRPHostAndPort="http://localhost:${bvt.prop.security_3_HTTP_default}"
		authorizationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}_RS256/authorize"
		tokenEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/token"
		validationEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/${oAuthOidcRSValidationEndpoint}"
		issuerIdentifier="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample},https://localhost:${bvt.prop.security_1_HTTP_default.secure}/${providerRoot}/endpoint/${providerSample}"
		jwkEndpointUrl="http://localhost:${bvt.prop.security_1_HTTP_default}/${providerRoot}/endpoint/${providerSample}/authorize"
		signatureAlgorithm="RS256"
		authFilterRef="someOtherUrlAuthFilter" />


	<keyStore
		id="multiKeyTrust"
		password="Liberty"
		type="jks"
		location="${server.config.dir}/commonMultiKeyTrustStore.jks" />

</server>
