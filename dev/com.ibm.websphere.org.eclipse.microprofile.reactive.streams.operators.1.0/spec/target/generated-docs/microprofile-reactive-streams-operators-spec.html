<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="James Roper, Clement Escoffier">
<title>MicroProfile Reactive Streams Operators Specification</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>MicroProfile Reactive Streams Operators Specification</h1>
<div class="details">
<span id="author" class="author">James Roper, Clement Escoffier</span><br>
<span id="email" class="email"><a href="mailto:james@lightbend.com">james@lightbend.com</a>, <a href="mailto:clement.escoffier@redhat.com">clement.escoffier@redhat.com</a></span><br>
<span id="revnumber"> 1.0-SNAPSHOT,</span>
<span id="revdate">July 11, 2018</span>
<br><span id="revremark">Draft</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_microprofile_reactive_streams_operators">MicroProfile Reactive Streams Operators</a></li>
<li><a href="#reactivestreamsarchitecture">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_rationale">Rationale</a></li>
<li><a href="#_scope">Scope</a></li>
<li><a href="#_reactive_streams_api_dependency">Reactive Streams API dependency</a></li>
</ul>
</li>
<li><a href="#_design">Design</a></li>
<li><a href="#reactivestreamsexamples">Reactive Streams Usage Examples</a>
<ul class="sectlevel2">
<li><a href="#_trivial_closed_graph">Trivial closed graph</a></li>
<li><a href="#_building_a_publisher">Building a publisher</a></li>
<li><a href="#_building_a_subscriber">Building a subscriber</a></li>
<li><a href="#_building_a_processor">Building a processor</a></li>
<li><a href="#_consuming_a_publisher">Consuming a publisher</a></li>
<li><a href="#_feeding_a_subscriber">Feeding a subscriber</a></li>
</ul>
</li>
<li><a href="#reactivestreams-java-streams">Similarities and differences with the Java Stream API</a>
<ul class="sectlevel2">
<li><a href="#_asynchronous_processing">Asynchronous processing</a></li>
<li><a href="#_no_parallel_processing">No parallel processing</a></li>
<li><a href="#_other_differences">Other differences</a></li>
</ul>
</li>
<li><a href="#_spi">SPI</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>Specification: MicroProfile Reactive Streams Operators Specification

Version: 1.0-SNAPSHOT

Status: Draft

Release: July 11, 2018

Copyright (c) 2018 Contributors to the Eclipse Foundation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   <a href="http://www.apache.org/licenses/LICENSE-2.0" class="bare">http://www.apache.org/licenses/LICENSE-2.0</a>

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microprofile_reactive_streams_operators"><a class="anchor" href="#_microprofile_reactive_streams_operators"></a>MicroProfile Reactive Streams Operators</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="reactivestreamsarchitecture"><a class="anchor" href="#reactivestreamsarchitecture"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification defines an API for manipulating Reactive Streams, providing operators such as <code>map</code>, <code>filter</code>, <code>flatMap</code>, in a similar fashion to the <code>java.util.streams</code> API introduced in Java 8.
It also provides an SPI for implementing and providing custom Reactive Streams engines, allowing application developers to use whichever engine they see fit.</p>
</div>
<div class="sect2">
<h3 id="_rationale"><a class="anchor" href="#_rationale"></a>Rationale</h3>
<div class="paragraph">
<p>The <code>java.util.streams</code> API provides functionality necessary for manipulating streams in memory introducing functional programming into the Java language.
However, manipulating potentially infinite asynchronous streams has some very different requirements which the <code>java.util.streams</code> API is not suitable for.</p>
</div>
<div class="paragraph">
<p>Reactive Streams is a specification for asynchronous streaming between different libraries and/or technologies, which is included in JDK9 as the <code>java.util.concurrent.Flow</code> spec.
Reactive Streams itself however is an SPI for library and technology vendors to implement, it is not intended that application developers implement it as the semantics are very complex.</p>
</div>
<div class="paragraph">
<p>Commonly, Reactive Streams requires more than just plumbing <code>publishers</code> to <code>subscribers</code>, the stream typically needs to be manipulated in some way, such as applying operations such as <code>map</code>, <code>filter</code> and <code>flatMap</code>.
Neither Reactive Streams, nor the JDK, provides an API for doing these manipulations.
Since users are not meant to implement Reactive Streams themselves, this means the only way to do these manipulations currently is to depend on a third party library providing operators, such as <a href="https://doc.akka.io/docs/akka/current/stream/index.html">Akka Streams</a>, <a href="https://github.com/ReactiveX/RxJava">RxJava</a> or <a href="https://projectreactor.io/">Reactor</a>.</p>
</div>
<div class="paragraph">
<p>This API seeks to fill that gap, so that MicroProfile application developers can manipulate Reactive Streams without bringing in a third party dependency.
By itself, this API is not interesting to MicroProfile, but with the addition of other Reactive features, such as the MicroProfile Reactive Messaging proposal, it is essential.</p>
</div>
<div class="paragraph">
<p>There are a number of different approaches to handling the cross cutting concerns relating to actually running streams.
These include how and whether context is propagated, concurrency models, buffering, hooks for monitoring and remoting.
Different implementations of Reactive Streams offer different approaches based on varying opinions on how these cross cutting concerns should be treated.
For this reason, this API provides an underlying SPI to allow different engines to be plugged in to actually run the streams.
Implementors of this spec will provide a default implementation, however users can select to use a custom implementation if they need.</p>
</div>
<div class="paragraph">
<p>This specification started as a proposal for the JDK, but after discussions there, it was decided that the JDK was not the right place to incubate such an API.
It is the intention that once incubated in MicroProfile, this specification will be put to the JDK again as a proposal.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope"><a class="anchor" href="#_scope"></a>Scope</h3>
<div class="paragraph">
<p>This specification aims to define a set of operators to manipulate Reactive Streams. The proposed API is voluntarily close to the <code>java.utils.Stream</code> API.</p>
</div>
<div class="paragraph">
<p>It does not define CDI and container API integrations but implementations may provide integrations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reactive_streams_api_dependency"><a class="anchor" href="#_reactive_streams_api_dependency"></a>Reactive Streams API dependency</h3>
<div class="paragraph">
<p>Reactive Streams has been included in the JDK9 as the <code>java.util.concurrent.Flow</code> API, which contains the <code>Publisher</code>, <code>Subscriber</code>, <code>Subscription</code> and <code>Processor</code> interfaces as nested interfaces of <code>Flow</code>.
MicroProfile however is not ready to move to a baseline requirement for JDK9 or above.</p>
</div>
<div class="paragraph">
<p>For this reason, this proposal uses the JDK6 compatible <code>org.reactivestreams</code> API, which provides identical <code>Publisher</code>, <code>Subscriber</code>, <code>Subscription</code> and <code>Processor</code> interfaces as members of the <code>org.reactivestreams</code> package.
This dependency contains nothing but those interfaces.</p>
</div>
<div class="paragraph">
<p>It has been discussed that MicroProfile could copy those interfaces itself, so as to not add this dependency, however this would most likely frustrate use of Reactive Streams in MicroProfile.
There is a large ecosystem built around the <code>org.reactivestreams</code> interfaces.
If application developers wanted to leverage that ecosystem in their application, they would have to write adapters to bridge the two APIs.
Given that the <code>org.reactivestreams</code> dependency is a jar that contains only these interfaces, identical to the interfaces in JDK9, there doesn&#8217;t seem to be any value in copying them again into MicroProfile.</p>
</div>
<div class="paragraph">
<p>To facilitate an eventual migration to the JDK9 interfaces, once MicroProfile adopts JDK9 or later as a baseline JDK version, all methods that pass <code>org.reactivestreams</code> interfaces to the user (either as a return value, or by virtue of a user providing a callback to the method to receive it) will have <code>Rs</code> added to their name.
For example, <code>getSubscriber</code> will be called <code>getRsSubscriber</code>.
This will allow new methods to be added in future that return <code>java.util.concurrent.Flow</code> interfaces, without the <code>Rs</code> in the name, allowing the existing <code>Rs</code> methods to be kept for a limited time for backwards compatibility.
Methods that accept a <code>org.reactivestreams</code> interface do not need to be given the same treatment, as support for the JDK9 interfaces can be added by overloading them, with backwards compatibility being maintained (see <a href="https://github.com/eclipse/microprofile-reactive/blob/master/approach.asciidoc">reactive approach for MicroProfile</a>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design"><a class="anchor" href="#_design"></a>Design</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The design of MicroProfile Reactive Streams is centered around <strong>builders</strong> for the various shapes of streams.
There are four different shapes of streams that can be built:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Processors. A processor has one inlet and one outlet, and is represented as a Reactive Streams <code>Processor</code> when built. This is called a <code>ProcessorBuilder</code>.</p>
</li>
<li>
<p>Publishers. A publisher has one outlet but no inlet, and is represented as a Reactive Streams <code>Publisher</code> when built. This is called a <code>PublisherBuilder</code></p>
</li>
<li>
<p>Subscribers. A subscriber has one inlet but no outlet, and it also has a result. It is represented as a product of a Reactive Streams <code>Subscriber</code> and a <code>CompletionStage</code> that is redeemed with the result, or error if the stream fails, when built. This is called a <code>SubscriberBuilder</code>.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/shapes.png" alt="Shapes" width="400" height="400">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Closed graphs. A closed graph has no inlet or outlet, both having being provided in during the construction of the graph</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It is represented as a <code>CompletionStage</code> of the result of the stream. This is called a <code>CompletionRunner</code>. The result is
retrieved using the <code>run</code> method.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/graph.png" alt="Closed graph" width="250" height="250">
</div>
</div>
<div class="paragraph">
<p>While building a stream, the stream may change shape during its construction.
For example, a publisher may be collected into a <code>List</code> of elements.
When this happens, the stream becomes a closed graph, since there is no longer an outlet, but just a result, the result being the <code>List</code> of elements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PublisherBuilder&lt;<span class="predefined-type">Integer</span>&gt; intsPublisher =
  ReactiveStreams.of(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>); <b class="conum">(1)</b>

CompletionRunner&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt;&gt; intsResult =
  intsPublisher.toList(); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A publisher of integers 1, 2 and 3.</p>
</li>
<li>
<p>A closed graph that emits all the received integers as a result.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Or, a processor may be plumbed to a subscriber, in which case, the resulting builder is now a subscriber:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ProcessorBuilder&lt;<span class="predefined-type">Integer</span>, <span class="predefined-type">String</span>&gt; toStringProcessor =
  ReactiveStreams.&lt;<span class="predefined-type">Integer</span>&gt;builder()
    .map(<span class="predefined-type">Object</span>::toString); <b class="conum">(1)</b>

SubscriberBuilder&lt;<span class="predefined-type">Integer</span>, <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt;&gt; toListSubscriber =
  toStringProcessor.toList(); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A processor that receives integers and emits them as strings.</p>
</li>
<li>
<p>A subscriber that receives integers, and emits all the integers as Strings in a List when the stream completes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When MicroProfile specifications provide an API that uses Reactive Streams, it is intended that application developers can return and pass the builder interfaces directly to the MicroProfile APIs.
In many cases, application developers will not need to run the streams themselves.
However, should they need to run the streams directly themselves, they can do so by using the streams <code>build</code> or <code>run</code>
methods. <code>PublisherBuilder</code>, <code>SubscriberBuilder</code> and <code>ProcessorBuilder</code> all provide a <code>build</code> method that returns a
<code>Publisher</code>, <code>CompletionSubscriber</code> and <code>Processor</code> respectively, while <code>CompletionRunner</code>, since it actually
runs the stream, provides a <code>run</code> method that returns a <code>CompletionStage</code>.</p>
</div>
<div class="paragraph">
<p>The <code>CompletionSubscriber</code> class is so named because, where a <code>CompletionStage</code> is a stage of asynchronous computation that completes with a value or an error, a <code>CompletionSubscriber</code> is subscriber to an asynchronous stream that completes with a value or an error.</p>
</div>
<div class="paragraph">
<p>The <code>build</code> and <code>run</code> methods both provide a zero arg variant, which uses the default Reactive Streams engine provided by the platform, as well as a overload that takes a <code>ReactiveStreamsEngine</code>, allowing application developers to use a custom engine when they please.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactivestreamsexamples"><a class="anchor" href="#reactivestreamsexamples"></a>Reactive Streams Usage Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_trivial_closed_graph"><a class="anchor" href="#_trivial_closed_graph"></a>Trivial closed graph</h3>
<div class="paragraph">
<p>This just shows the fluency of the API.
It wouldn&#8217;t make sense to actually do the below in practice, since the JDK8 streams API itself is better for working with in memory streams.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CompletionStage&lt;Optional&lt;<span class="predefined-type">Integer</span>&gt;&gt; result = ReactiveStreams
    .fromIterable(() -&gt; IntStream.range(<span class="integer">1</span>, <span class="integer">1000</span>).boxed().iterator())
    .filter(i -&gt; (i &amp; <span class="integer">1</span>) == <span class="integer">1</span>)
    .map(i -&gt; i * <span class="integer">2</span>)
    .collect(Collectors.reducing((i, j) -&gt; i + j))
    .run();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_a_publisher"><a class="anchor" href="#_building_a_publisher"></a>Building a publisher</h3>
<div class="paragraph">
<p>This shows how common collection types can be converted to a <code>Publisher</code> of the elements in the collection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;MyDomainObject&gt; domainObjects = ...

Publisher&lt;<span class="predefined-type">ByteBuffer</span>&gt; publisher = ReactiveStreams
    .fromIterable(domainObjects)
    .buildRs(); <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>Rs</code> suffix indicates the method produces a Reactive Streams <code>Publisher</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above example shows a very simple conversion of a <code>List</code> to a <code>Publisher</code>, of course other operations can be done on the elements before building the <code>Publisher</code>, in this case we go on to transform each object to a line in a CSV file, and then represent it as a stream of bytes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Publisher&lt;<span class="predefined-type">ByteBuffer</span>&gt; publisher = ReactiveStreams
    .map(obj -&gt; <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s,%s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, obj.getField1(), obj.getField2()))
    .map(line -&gt; <span class="predefined-type">ByteBuffer</span>.wrap(line.getBytes()))
    .buildRs();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_a_subscriber"><a class="anchor" href="#_building_a_subscriber"></a>Building a subscriber</h3>
<div class="paragraph">
<p>This shows building a subscriber for a byte stream, such as for the JDK9 HttpClient API.
It assumes another library has provided a Reactive Streams Processor that parses byte streams into streams of objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Processor&lt;<span class="predefined-type">ByteBuffer</span>, MyDomainObject&gt; parser = createParser();

CompletionSubscriber&lt;<span class="predefined-type">ByteBuffer</span>, <span class="predefined-type">List</span>&lt;MyDomainObject&gt;&gt; subscriber =
  ReactiveStreams.&lt;<span class="predefined-type">ByteBuffer</span>&gt;builder()
    .via(parser)
    .toList()
    .build();

Subscriber&lt;<span class="predefined-type">ByteBuffer</span>&gt; subscriber = subscriber; <b class="conum">(1)</b>
CompletionStage&lt;<span class="predefined-type">List</span>&lt;MyDomainObject&gt;&gt; result = subscriber.getCompletion(); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The object can be deconstructed into the <code>Subscriber</code> part</p>
</li>
<li>
<p>The <code>CompletionStage</code> can be retrieve using <code>getCompletion</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_building_a_processor"><a class="anchor" href="#_building_a_processor"></a>Building a processor</h3>
<div class="paragraph">
<p>This shows building a processor, for example, a message library may require processing messages, and then emitting an ACK identifier so that each handled element can be acknowledged as handled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Processor&lt;Message&lt;MyDomainObject&gt;, MessageAck&gt; processor =
    ReactiveStreams.&lt;Message&lt;MyDomainObject&gt;&gt;builder()
      .map(message -&gt; {
        handleDomainObject(message.getMessage());
        <span class="keyword">return</span> message.getMessageAck();
      })
      .buildRs();
  }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consuming_a_publisher"><a class="anchor" href="#_consuming_a_publisher"></a>Consuming a publisher</h3>
<div class="paragraph">
<p>A library may provide a Reactive Streams publisher that the application developer needs to consume.
This shows how that can be done.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Publisher&lt;<span class="predefined-type">ByteBuffer</span>&gt; bytesPublisher = makeRequest();

Processor&lt;<span class="predefined-type">ByteBuffer</span>, MyDomainObject&gt; parser = createParser();

CompletionStage&lt;<span class="predefined-type">List</span>&lt;MyDomainObject&gt;&gt; result = ReactiveStreams
    .fromPublisher(bytesPublisher)
    .via(parser)
    .toList()
    .run();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_feeding_a_subscriber"><a class="anchor" href="#_feeding_a_subscriber"></a>Feeding a subscriber</h3>
<div class="paragraph">
<p>A library may provide a subscriber to feed a connection.
This shows how that subscriber can be fed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;MyDomainObject&gt; domainObjects = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

Subscriber&lt;<span class="predefined-type">ByteBuffer</span>&gt; subscriber = createSubscriber();

CompletionStage&lt;<span class="predefined-type">Void</span>&gt; completion = ReactiveStreams
    .fromIterable(domainObjects)
    .map(obj -&gt; <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">%s,%s</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, obj.getField1(), obj.getField2()))
    .map(line -&gt; <span class="predefined-type">ByteBuffer</span>.wrap(line.getBytes()))
    .to(subscriber)
    .run();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactivestreams-java-streams"><a class="anchor" href="#reactivestreams-java-streams"></a>Similarities and differences with the Java Stream API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API shares a lot of similarities with the <a href="https://docs.oracle.com/javase/9/docs/api/java/util/stream/Stream.html">Java
Stream API</a>. This similarity has been done on purpose to ease the adoption of the API. However, there are some
differences and this section highlights them.</p>
</div>
<div class="sect2">
<h3 id="_asynchronous_processing"><a class="anchor" href="#_asynchronous_processing"></a>Asynchronous processing</h3>
<div class="paragraph">
<p>The goal of the Reactive Stream Operators specification is to define building blocks to enable the
implementation of asynchronous processing of stream of data. On the other hand, the Java Stream API provides a synchronous
 approach to compute a result by analyzing data conveyed in a stream. Because of this asynchronous vs. synchronous
 processing, the terminal stages (such as <code>collect</code>, <code>findFirst</code>&#8230;&#8203;) define by this API return <code>CompletableStage&lt;T&gt;</code> and
 not <code>T</code>. Indeed, only when the result has been computed the returned <code>CompletableStage</code> is completed. As an example,
 here is the two versions of the same processing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; list = <span class="predefined-type">Arrays</span>.asList(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>, <span class="integer">7</span>, <span class="integer">8</span>, <span class="integer">9</span>, <span class="integer">10</span>);

<span class="comment">// Java Stream version</span>
<span class="type">int</span> sum = list.stream()
  .map(i -&gt; i + <span class="integer">1</span>)
  .mapToInt(i -&gt; i)
  .sum();
<span class="comment">// At the point the sum is computed</span>
<span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">sum: </span><span class="delimiter">&quot;</span></span> + sum);

<span class="comment">// Reactive Streams Operators version</span>
CompletionStage&lt;<span class="predefined-type">Integer</span>&gt; future = ReactiveStreams.fromIterable(list)
  .map(i -&gt; i + <span class="integer">1</span>)
  .collect(Collectors.summingInt(i -&gt; i))
  .run();
future.whenComplete((res, err) -&gt; <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">async sum: </span><span class="delimiter">&quot;</span></span> + res));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The asynchronous vs. synchronous difference also means that the error propagation works differently. In the Java Streams
API, the processing can be wrapped in a <code>try/catch</code> construct. In the asynchronous case, the error is propagated into the
returned future. In the example above, the function passed to the <code>whenComplete</code> stage receives the result as well as the
failure (if any). If the processing throws an exception, the function can react by looking at the <code>err</code> parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_no_parallel_processing"><a class="anchor" href="#_no_parallel_processing"></a>No parallel processing</h3>
<div class="paragraph">
<p>The Reactive Streams specification is intrinsically sequential. So none of the parallel processing ability from the Java
Stream API are supported. As a consequence, the API does not provide a <code>parallel()</code> method. Also, operations like
<code>findAny</code> are not provided as the behavior would be equivalent to the provided <code>findFirst</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_other_differences"><a class="anchor" href="#_other_differences"></a>Other differences</h3>
<div class="ulist">
<ul>
<li>
<p><code>allMatch</code>, <code>anyMatch</code> and <code>nonMatch</code> can be achieved by combining <code>filter</code> and <code>findFirst</code></p>
</li>
<li>
<p><code>collect(Collector&lt;? super T,A,R&gt; collector)</code> - the combiner part of the collector is not used because of the sequential
nature of Reactive Streams.</p>
</li>
<li>
<p><code>collect(Supplier&lt;R&gt; supplier, BiConsumer&lt;R,? super T&gt; accumulator, BiConsumer&lt;R,R&gt; combiner)</code> is provided as <code>collect
(Supplier&lt;R&gt; supplier, BiConsumer&lt;R,? super T&gt; accumulator)</code>. Indeed, the combiner is not used because of the sequential
nature of Reactive Streams.</p>
</li>
<li>
<p><code>count</code> is not provided but can be implemented using <code>.collect(Collectors.counting())</code> instead.</p>
</li>
<li>
<p><code>findAny</code> is not supported, use <code>findFirst</code> instead. Because of the sequential nature of Reactive Streams, the method
has the same semantic.</p>
</li>
<li>
<p><code>flatMapTo</code> and <code>mapTo</code> are not provided. These can easily be replaced using regular <code>flatMap</code> and <code>map</code> methods, or
methods from <code>Collectors</code>.</p>
</li>
<li>
<p><code>forEachOrdered</code> is not provided as Reactive Streams mandates ordering. So <code>forEach</code> should be used instead.</p>
</li>
<li>
<p><code>max</code> and <code>min</code> can be achieved using <code>.collect(Collectors.maxBy(&#8230;&#8203;))</code> and <code>.collect(Collectors.minBy(&#8230;&#8203;))</code></p>
</li>
<li>
<p><code>sorted</code> is not supported</p>
</li>
<li>
<p><code>toArray</code> is not supported, <code>toList</code> can be used instead</p>
</li>
<li>
<p><code>onClose</code> is replaced by <code>onComplete</code>. Notice that the API also provides the <code>onError</code> and <code>onTerminate</code> methods.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spi"><a class="anchor" href="#_spi"></a>SPI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API is responsible for building graphs of stages based on the operators the user invoked.
The stages form an SPI for <code>ReactiveStreamsEngine</code> implementations to build into a running stream.
Examples of stages include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Map</p>
</li>
<li>
<p>Filter</p>
</li>
<li>
<p>Elements to publish</p>
</li>
<li>
<p>Collect</p>
</li>
<li>
<p>Instances of Reactive Streams <code>Publisher</code>, <code>Subscriber</code> and <code>Processor</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each stage has either an inlet, an outlet, or both.
A graph is a sequence of stages, consecutive stages will have an outlet and and inlet so that they can join - a graph that has a stage with no outlet followed by a stage that has an inlet is impossible, for example.
Only the stages at the ends of the graph may have no inlet or outlet, whether these end stages have an inlet or outlet determines the shape of the overall graph.
The API is responsible for ensuring that as graphs are constructed, only graphs that are logically possible are passed to the <code>ReactiveStreamsEngine</code> to construct.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 1.0-SNAPSHOT<br>
Last updated 2018-07-11 10:13:51 BST
</div>
</div>
</body>
</html>