/*******************************************************************************
 * Copyright (c) 2018,2022 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License 2.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-2.0/
 * 
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     IBM Corporation - initial API and implementation
 *******************************************************************************/

task copyPublishMassiveRepo(type: Copy) {
    from 'publish/massiveRepo'
    into 'build/massiveRepo'
    include 'features/usertest.with.ibm.license.esa'
    include 'fixes/8550-wlp-archive-ifpm89011.jar'
    include 'samples/SampleX.jar'
}

task copyPublishZips(type: Copy) {
    from 'publish/zips'
    into 'build/unittest/zips'
    include 'com.ibm.websphere.liberty.repo.core.manifest_8.5.5005.zip'
    include 'invalid.zip'
}

task copyPublishZipsWlpDirs(type: Copy) {
    from zipTree('publish/zips/wlpDirs.zip')
    into 'build/unittest/wlpDirs'
}

task massiveCopyTask {
    dependsOn copyPublishMassiveRepo
    dependsOn copyPublishZips
    dependsOn copyPublishZipsWlpDirs
    outputs.dirs('build/unittest/tmp')
    doFirst {
        project.mkdir('build/unittest/tmp')
    }
}

jar.dependsOn(massiveCopyTask)

test {
    dependsOn jar
    jvmArgs = ["--add-opens", "java.base/java.lang=ALL-UNNAMED"]
}
