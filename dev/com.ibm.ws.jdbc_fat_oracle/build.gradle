/*******************************************************************************
 * Copyright (c) 2019, 2023 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License 2.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-2.0/
 * 
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     IBM Corporation - initial API and implementation
 *******************************************************************************/
apply from: "../wlp-gradle/subprojects/maven-central-mirror.gradle"

// Use a variable for the oracle version so that we can test customer issues easily
ext.oracleVersion = '23.4.0.24.05'

configurations {
  oracle	{transitive = false}
  oraclessl	{transitive = false}
  ucp     	{transitive = false}
}

dependencies {
  oracle        "com.oracle.database.jdbc:ojdbc8:${oracleVersion}"
  oraclessl     "com.oracle.database.jdbc:ojdbc8:${oracleVersion}",
               	"com.oracle.database.security:oraclepki:${oracleVersion}"			
  ucp           "com.oracle.database.jdbc:ucp:${oracleVersion}"
}

task copyAnonymousOracle(type: Copy) {
  shouldRunAfter jar
  from configurations.oracle
  into new File(autoFvtDir, "publish/shared/resources/oracle/")
  rename "ojdbc8-.*.", "oracleunknown.jar"
}

task copySharedOracle(type: Copy) {
  shouldRunAfter jar
  from configurations.oracle
  into new File(autoFvtDir, "publish/shared/resources/ucp/")
  rename "ojdbc8-.*.", "ojdbc8.jar"
}

task copySharedUCP(type: Copy) {
  shouldRunAfter jar
  from configurations.ucp
  into new File(autoFvtDir, "publish/shared/resources/ucp/")
  rename "ucp-.*.", "ucp.jar"
}

task copySharedOracleSSL(type: Copy) {
  shouldRunAfter jar
  from configurations.oraclessl
  into new File(autoFvtDir, "publish/shared/resources/ssl/")
  rename "ojdbc8-.*.", "ojdbc8.jar"
  rename "oraclepki.*.", "oraclepki.jar"
}

addRequiredLibraries {
  dependsOn copySharedOracle
  dependsOn copySharedUCP
  dependsOn copyAnonymousOracle
  dependsOn copySharedOracleSSL
  dependsOn copyTestContainers
}